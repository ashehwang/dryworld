{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./index.js"],"names":["svg","d3","select","projection","geoEckert4","pathGenerator","geoPath","g","append","attr","call","zoom","on","event","transform","colorScale","scaleOrdinal","colorValue","d","properties","risk","Promise","all","tsv","json","then","tsvData","topoJSONdata","rowById","forEach","iso_n3","console","log","countries","topojson","feature","objects","features","Object","assign","id","domain","map","sort","reverse","range","schemeYlOrRd","length","myColorScale","selectAll","data","enter","text","name","svg2","width","height","render","filter","margin","top","right","bottom","left","innerHeight","innerWidth","yValue","water","xValue","action","filteredData","xScale","scaleBand","padding","yScale","scaleLinear","max","axisLeft","axisBottom","bandwidth","csv","selector","myFilter","document","getElementsByName","node","addEventListener","checked","value","target","querySelector","innerHTML","transition","duration","style"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","const svg = d3.select(\"svg.dry-map\");\n\n// const projection = d3.geoNaturalEarth1();\nconst projection = d3.geoEckert4();\nconst pathGenerator = d3.geoPath().projection(projection)\n\nconst g = svg.append('g')\n\ng.append('path')\n    .attr('class', 'sphere')\n    // .attr('d', pathGenerator({type: 'Sphere'}))\n\nsvg.call(d3.zoom().on('zoom', () => {\n    g.attr('transform', d3.event.transform)\n}));\n\nconst colorScale = d3.scaleOrdinal();\nconst colorValue = d => d.properties.risk\n\nPromise.all([\n    d3.tsv('./src/fullwaterdata.tsv'),\n    d3.json('https://unpkg.com/world-atlas@1.1.4/world/110m.json')\n]).then(([tsvData, topoJSONdata]) => {\n        const rowById = {};\n        tsvData.forEach( d => {\n            rowById[d.iso_n3] = d;\n        })\n\n        console.log(topoJSONdata)\n\n        const countries = topojson.feature(topoJSONdata, topoJSONdata.objects.countries)\n\n        countries.features.forEach( d => {\n            Object.assign(d.properties, rowById[d.id])\n        })\n\n        colorScale.domain(countries.features.map(colorValue))\n            .domain(colorScale.domain().sort().reverse())\n            .range(d3.schemeYlOrRd[colorScale.domain().length])\n            // .range(d3.schemeYlGn[colorScale.domain().length])\n            \n        console.log(colorScale.domain().sort())\n\n        const myColorScale = d3.scaleOrdinal()\n            .domain([\"\", \"Low\", \"Low-Medium\", \"Medium-High\", \"High\", \"Extremely High\"])\n            .range(['white', '#ffff99', '#ffe600', '#ff9900', '#ff1900', '#9a0500'])\n\n        g.selectAll('path')\n            .data(countries.features)\n            .enter().append('path')\n                .attr('class', 'country')\n                .attr('d', pathGenerator)\n                // .attr('fill', d => colorScale(colorValue(d)))\n                .attr('fill', d => myColorScale(colorValue(d)))\n            .append('title')\n                .text(d => d.properties.name + ': ' + colorValue(d) + ' Risk')\n})\n\nconst svg2 = d3.select('svg.water-bars')\n\nconst width = +svg2.attr(\"width\");\nconst height = +svg2.attr(\"height\");\n\nconst render = (data, filter) => {\n    const margin = { top: 20, right: 20, bottom: 20, left: 80 };\n    const innerHeight = height - margin.top - margin.bottom;\n    const innerWidth = width - margin.left - margin.right;\n    const yValue = d => d.water;\n    const xValue = d => d.action;\n\n    const filteredData = data.filter( d => d.filter === filter)\n\n    const xScale = d3.scaleBand()\n        // .domain(data.filter( d => d.filter === filter).map(xValue))\n        // .domain(data.map(xValue))\n        .domain(filteredData.map(xValue))\n        .range([0, innerWidth])\n        .padding(0.1);\n\n    console.log(xScale.domain())\n\n    const yScale = d3.scaleLinear()\n        .domain([0, d3.max(filteredData, yValue)])\n        // .domain([0, d3.max(data, yValue)])\n        // .domain([0, data.filter( d => d.filter === filter).d3.max(yValue)])\n        .range([innerHeight, 0]);\n\n    const g = svg2.append('g')\n        .attr('transform', `translate(${margin.left}, ${margin.top})`);\n\n    g.append('g').call(d3.axisLeft(yScale))\n    // .tickSize(10)\n    // .tickFormat('.3s')\n    // .select('.domain')\n    // .remove();\n\n    g.append(\"g\")\n        .call(d3.axisBottom(xScale))\n        .attr(\"transform\", `translate(0, ${innerHeight})`);\n    //   .append('text')\n    //     .attr('y', 0)\n    //     .attr('fill', 'black')\n    //     .text('water spent in gallons')\n    // .selectAll('.domain, .tick line')\n    // .remove();\n\n    g.selectAll('rect').data(filteredData)\n        .enter().append('rect')\n        .attr('class', 'bar')\n        .attr('x', d => xScale(d.action))\n        .attr('y', d => yScale(d.water))\n        .attr('width', xScale.bandwidth())\n        .attr('height', d => innerHeight - yScale(d.water));\n};\n\nd3.csv('./src/data.csv').then(data => {\n    data.forEach(d => {\n        d.water = +d.water;\n    });\n\n    let selector = \"flush\";\n    let myFilter = document.getElementsByName('filter');\n    console.log(myFilter)\n\n    render(data, selector);\n\n    myFilter.forEach( node => node.addEventListener('change', () => {\n        if(node.checked) selector = node.value;\n        let target = document.querySelector('.water-bars')\n        target.innerHTML = \"\"\n        render(data, selector)\n        d3.selectAll('rect')\n            .transition()\n            .duration(2000)\n            .style('fill', '#9AB9D5')\n            // .style('fill', 'url(#gradient)')\n        // console.log(node)\n    }));\n\n    console.log(selector)\n\n});"],"sourceRoot":""}